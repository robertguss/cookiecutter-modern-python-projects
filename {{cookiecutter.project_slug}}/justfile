set shell := ["bash", "-ceu"]

venv := ".venv"
python_version := "3.13"

default:
    @just --list

build:
    uv build

check:
    uv run ruff check .
    uv run ruff format --check .
    uv run deptry .

clean:
    rm -rf .venv
    rm -rf .ruff_cache
    rm -rf .pytest_cache
    rm -rf htmlcov
    rm -rf .coverage
    rm -rf dist
    rm -rf build
    rm -rf *.egg-info
    find . -type d -name __pycache__ -delete
    find . -type f -name "*.pyc" -delete

dev-setup:
        install pre-commit-install
    @echo "ðŸŽ‰ Development environment setup complete!"
    @echo "Run 'just test' to run tests"
    @echo "Run 'just docs-serve' to serve documentation"

docs-build:
    uv run mkdocs build

docs-deploy:
    uv run mkdocs gh-deploy

docs-serve:
    uv run mkdocs serve

format:
    uv run ruff format .

install:
    uv venv {{ "{{" }}venv{{ "}}" }} --python={{ "{{" }}python_version{{ "}}" }}
    uv pip install -e ".[dev]"

install-prod:
    uv venv {{ "{{" }}venv{{ "}}" }} --python={{ "{{" }}python_version{{ "}}" }}
    uv pip install -e .

lint:
    uv run ruff check --fix .

pre-commit-install:
    uv run pre-commit install

pre-commit-run:
    uv run pre-commit run --all-files

publish:
    uv publish

test:
    uv run pytest

test-cov:
    uv run pytest --cov-report=html
    @echo "Coverage report generated in htmlcov/index.html"
